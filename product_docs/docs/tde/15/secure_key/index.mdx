---
title: Securing the data encryption key
description: Learn how to secure your data with an encryption key.
deepToC: true
navigation: 
- passphrase
- key_store
- key-rotation
---

The key for transparent data encryption (the data key) is normally generated by `initdb` and stored in a file `pg_encryption/key.bin` under the data directory. This file actually contains several keys that are used for different purposes at run time. However, in terms of the data key, it contains a single sequence of random bytes.

Without any further action, this file contains the key in plaintext, which isn't secure. Anyone with access to the encrypted data directory has access to the plaintext key, which defeats the purpose of encryption. Therefore, this setup is suitable only for testing purposes.

To secure the data key properly, “wrap” it by encrypting it with another key. Broadly, you can use two approaches to arrange this:

- [Protect the data key with a passphrase](passphrase). A wrapping key is derived from the passphrase and used to encrypt the data key.

- [Protect the data key with a wrapping key stored in a Key Management System](key_store) or key store. This second key is also called the *key-wrapping key* or *master key*.

If you don't want key wrapping, for example for testing, then you must set the wrap and unwrap commands to the special value `-`. This setting specifies to use the key from the file without further processing. This approach differs from not setting a wrap or unwrap command at all, and from setting either/both to an empty string. Having no wrap or unwrap command set when transparent data encryption is used results in a fatal error when running an affected utility program.

Postgres leaves this configuration up to the user, which allows tailoring the setup to local requirements and integrating with existing key management software or similar. To configure the data key protection, you must specify a pair of external commands that take care of the wrapping (encrypting) and unwrapping (decryption). The [Using a passphrase](passphrase) and [Using a key store](key_store) options provide examples for the wrapping commands.

