---
title: "Beginning PostgreSQL Security"
navTitle: "Beginning Security"
deepToC: true
---

This guide will walk you through the basics of securing your PostgreSQL installation.

### 1. Install the Latest Version
- **Always use the most recent version**: Regularly update PostgreSQL to the latest stable release.  For EDB releases, see the [EDB repositories](https://www.enterprisedb.com/repos-downloads).
- **Apply Security Patches**: Ensure security patches are applied promptly.  For EDB security vulnerabilities and advisories, see the [EDB Vulnerability disclosure policy](https://www.enterprisedb.com/docs/security/vulnerability-disclosure-policy/).

### 2. Use Strong Authentication Methods
PostgreSQL supports several authentication methods. You should always use the most secure option available:

- **Password Authentication**:  Ensure that all users authenticate with strong passwords.  Use `scram-sha-256` for password hashing instead of `md5` because it provides stronger hashing.
- **LDAP/Kerberos/SSO**: Integrate centralized authentication systems like LDAP, Kerberos, or Single Sign-On (SSO) for enhanced security.

### 3. Limit Access with `pg_hba.conf`
PostgreSQL’s host-based access control file (pg_hba.conf) is your first line of defense for controlling who can connect to the database. To ensure security:

- **Restrict Host Connections**: Only allow trusted hosts.
- **Use CIDR Notation**: Limit access to specific IP ranges in `pg_hba.conf`.  Example:
```bash
host all all 192.168.1.0/24 scram-sha-256
```
- **Local Method**:  For connections from the same machine, use Unix domain sockets with peer authentication, limiting connections to system users.

### 4. Enforce SSL/TLS Connections
Encrypt traffic between the client and PostgreSQL server using SSL. This can prevent sensitive data (like passwords and query results) from being intercepted.

- **Enable SSL**: Ensure that `ssl = on` in `postgresql.conf`.
- **Use Valid SSL Certificates**: Use certificates for secure communication (self-signed or CA-signed).
- **Force SSL**: Ensure all connections use SSL via `pg_hba.conf`.  Example:
```bash
hostssl all all 0.0.0.0/0 scram-sha-256
```

### 5. Role-Based Access Control (RBAC)
PostgreSQL implements a robust role-based access control system. Some key practices include:

- **Principle of Least Privilege**: Grant roles the minimum permissions necessary.
- **Separate Roles for Users/Applications**: Avoid using superuser accounts or the default `postgres` role for daily operations.
- **Use GRANT/REVOKE**: Assign roles specific privileges.  Example:

```sql
GRANT SELECT, INSERT ON my_table TO my_user;
```

### 6. Use Encrypted Passwords
Make sure that passwords are stored using secure hashing methods (scram-sha-256 in modern PostgreSQL versions). 

- **Enable scram-sha-256**: Configure PostgreSQL to store passwords securely by setting `password_encryption = 'scram-sha-256'` in your `postgresql.conf` file.

```bash
password_encryption = 'scram-sha-256'
```

### 7. Audit and Monitor Database Activity
Enable logging and auditing to keep track of database activity:

- **Enable Logging**: Log all user connections and queries.
- **Track Role Changes**: Regularly audit role modifications and permissions to detect unauthorized changes.
- **Use `pgaudit`**: Third-Party tools like  the `pgaudit` extension can enable detailed audit logging.
- **Enable Connection and Query Logs**: Capture login attempts, successful connections, and queries executed using settings in `postgresql.conf`:

```bash
log_connections = on
log_disconnections = on
log_statement = 'all'
```

### 8. Regular Backups and Secure Backup Storage
Backups are crucial, but they must also be secured. Ensure you:

- **Use Encrypted Backups**: Encrypt database backups to reduce the chance of unauthorized access.
- **Restrict Backup Access**: Only authorized personnel should access, view, or restore backups.
- **Test Restores**: Regularly test backups to ensure they are complete and can be restored properly without any data integrity issues.


### 9. Disable Unnecessary Features

Reduce your attack surface by disabling unused features:

- **Remove Unused Extensions**: Disable any extensions that aren't actively used.
- **Disable Trust Authentication**: Ensure `trust` authentication is not used in production as it allows users to log in without a password.
- **Disable Untrusted Languages**: Prevent the use of languages like `plpythonu` that allow arbitrary code execution.


### 10. Vulnerability Scanning and Penetration Testing
- **Regularly Scan for Vulnerabilities**: Use security scanners to find vulnerabilities.
- **Penetration Testing**: Test the security of your PostgreSQL instance.  You may need to hire security professionals to test your database security periodically.


### 11. Network Security Controls
Strengthen PostgreSQL’s security by securing the network it operates in:

- **Firewall Rules**: Restrict database access to necessary ports.
- **Limit Network Exposure**: Use VPNs or internal networks for database access.  Avoid exposing PostgreSQL directly to the internet.
- **Intrusion Detection**: Use IDS tools to monitor for suspicious activity.


### 12. Regularly Review User Permissions
- **Develop a review cadence**: Regularly review user and role permissions to ensure no unnecessary privileges have been granted. 
- **Remove Unnecessary Privileges**: Periodically review and revoke unnecessary privileges.  Remove access immediately when a user no longer needs it.

### 13. Secure OS and File Permissions
PostgreSQL runs on an operating system that also needs to be secured:

- **Restrict File Access**: Ensure that only the PostgreSQL service user can access critical files such as the data directory and logs.  Set restrictive permissions (700) on the data directory.
- **Harden the OS**: Apply operating system hardening practices, including disabling unnecessary services and ensuring regular OS updates.


 