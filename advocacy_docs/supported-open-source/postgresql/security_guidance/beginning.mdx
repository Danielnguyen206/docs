---
title: "Beginning"
navTitle: "Beginning Security"
---
## PostgreSQL Security 101: Basic Guidance

This guide will walk you through the basics of securing your PostgreSQL installation.

### 1. Install the Latest Version
- **Always use the most recent version**: Regularly update PostgreSQL to the latest stable release.
- **Apply Security Patches**: Ensure security patches are applied promptly.

### 2. Use Strong Authentication Methods
- **Password Authentication**: Use `scram-sha-256` for password hashing instead of `md5`.
- **LDAP/Kerberos/SSO**: Integrate centralized authentication systems like LDAP or Kerberos for enhanced security.

PostgreSQL supports several authentication methods. You should always use the most secure option available:

Password Authentication (md5 or scram-sha-256): Ensure that all users authenticate with strong passwords. In newer PostgreSQL versions, scram-sha-256 is preferred over md5 because it provides stronger hashing.
LDAP/Kerberos/SSO: For enterprise environments, consider integrating with more secure, centralized authentication mechanisms like LDAP, Kerberos, or Single Sign-On (SSO).

### 3. Limit Access with `pg_hba.conf`
- **Restrict Host Connections**: Only allow trusted hosts.
- **Use CIDR Notation**: Limit access to specific IP ranges in `pg_hba.conf`.
- **Local Method**: Use peer authentication for local connections.

PostgreSQL’s host-based access control file (pg_hba.conf) is your first line of defense for controlling who can connect to the database. To ensure security:

Restrict Host Connections: Only allow trusted hosts to connect.
Use CIDR Notation: Limit access to specific IP ranges. Example:

```bash
host all all 192.168.1.0/24 scram-sha-256
```
Use the "local" Method: For connections from the same machine, use Unix domain sockets with peer authentication, limiting connections to system users.

### 4. Enforce SSL/TLS Connections
- **Enable SSL**: Ensure that `ssl = on` in `postgresql.conf`.
- **Use Valid SSL Certificates**: Use certificates for secure communication.
- **Force SSL**: Ensure all connections use SSL via `pg_hba.conf`.

Encrypt traffic between the client and PostgreSQL server using SSL. This prevents sensitive data (like passwords and query results) from being intercepted.

    Enable SSL: Set ssl = on in your postgresql.conf.
    Use Valid SSL Certificates: Use proper certificates for encryption (self-signed or CA-signed).
    Force SSL: Require all connections to use SSL by adjusting the pg_hba.conf file:

```bash
hostssl all all 0.0.0.0/0 scram-sha-256
```

### 5. Role-Based Access Control (RBAC)
- **Principle of Least Privilege**: Grant roles the minimum permissions necessary.
- **Separate Roles for Users/Applications**: Avoid using superuser accounts for daily operations.
- **Use GRANT/REVOKE**: Assign roles specific privileges.

PostgreSQL implements a robust role-based access control system. Some key practices include:

    Follow the Principle of Least Privilege: Grant users only the permissions they need.
    Separate Roles for Users and Applications: Avoid using superuser accounts or the default postgres role for day-to-day operations.
    Use GRANT and REVOKE: Ensure each role has only the necessary permissions. For example:

```sql
GRANT SELECT, INSERT ON my_table TO my_user;
```

### 6. Use Encrypted Passwords
- **Enable scram-sha-256**: Configure PostgreSQL to store passwords securely by setting `password_encryption = 'scram-sha-256'`.

Make sure that passwords are stored using secure hashing methods (scram-sha-256 in modern PostgreSQL versions). You can enforce this with the following in postgresql.conf:

```bash
password_encryption = 'scram-sha-256'
```

### 7. Audit and Monitor Database Activity
- **Enable Logging**: Log all user connections and queries.
- **Track Role Changes**: Regularly audit role modifications.
- **Use `pgaudit`**: Enable detailed logging with the `pgaudit` extension.

Enable logging and auditing to keep track of database activity:

Enable Connection and Query Logs: Capture login attempts, successful connections, and queries executed using settings in postgresql.conf:

```bash
log_connections = on
log_disconnections = on
log_statement = 'all'
```

Track Role Changes and Permission Grants: Regularly audit roles and permissions to detect unauthorized changes.

Use Third-Party Tools: Tools like pgaudit can provide more detailed logging of user activity.

### 8. Regular Backups and Secure Backup Storage
- **Use Encrypted Backups**: Encrypt database backups.
- **Restrict Backup Access**: Only authorized personnel should access backups.
- **Test Restores**: Regularly test backups for data integrity.

Backups are crucial, but they must also be secured. Ensure that:

Use Encrypted Backups: Encrypt your backups to prevent unauthorized access.
Restrict Access to Backups: Only authorized personnel should be able to view or restore backups.
Test Restores Regularly: Test your backups to ensure they are complete and can be restored properly.


### 9. Disable Unnecessary Features

Reduce your attack surface by disabling unused features:

- **Remove Unused Extensions**: Disable any extensions not being used.
- **Disable trust Authentication**: Ensure `trust` authentication is not used in production.
- **Disable Untrusted Languages**: Prevent the use of languages like `plpythonu` that allow arbitrary code execution.



    Remove/Disable Unused Extensions: Only enable extensions that you actively use.
    Disable trust Authentication: trust authentication allows users to log in without a password, which should be avoided in production environments.
    Disable Superuser Access to Untrusted Languages: Prevent the use of languages that allow executing arbitrary code, like plpythonu.

### 10. Vulnerability Scanning and Penetration Testing
- **Regularly Scan for Vulnerabilities**: Use security scanners to find vulnerabilities.
- **Penetration Testing**: Test the security of your PostgreSQL instance.

Regularly scan your database for vulnerabilities:

    Use Security Scanners: Use tools to check for known vulnerabilities in your PostgreSQL setup.
    Perform Penetration Testing: Hire security professionals to test your database security periodically.

### 11. Network Security Controls
- **Firewall Rules**: Restrict database access to necessary ports.
- **Limit Network Exposure**: Use VPNs or internal networks for database access.
- **Intrusion Detection**: Use IDS tools to monitor for suspicious activity.

Strengthen PostgreSQL’s security by securing the network it operates in:

    Firewall Rules: Only allow database access on necessary ports (usually port 5432).
    Limit Database Network Exposure: Avoid exposing PostgreSQL directly to the internet. Use VPNs or internal networks for access.
    Intrusion Detection Systems (IDS): Monitor for suspicious activity using network intrusion detection tools.


### 12. Regularly Review User Permissions
- **Remove Unnecessary Privileges**: Periodically review and revoke unnecessary privileges.

Regularly review user and role permissions to ensure no unnecessary privileges have been granted. Remove access immediately when a user no longer needs it.

### 13. Secure OS and File Permissions
- **Restrict File Access**: Ensure that only PostgreSQL’s service user can access critical files.
- **Harden the OS**: Apply operating system hardening practices.

PostgreSQL runs on an operating system that also needs to be secured:

    Restrict File Access: Only allow the PostgreSQL service user to access the data directory and logs. Set restrictive permissions (700) on the data directory.
    Harden the OS: Follow best practices for hardening the underlying operating system, including disabling unnecessary services and ensuring regular OS updates.

